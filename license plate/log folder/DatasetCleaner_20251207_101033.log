(myenv) PS D:\Pytorch 2\lpr_system> python scripts/04_clean_dataset.py
2025-12-07 10:10:34,962 - INFO - Loaded small detector from: models/pretrained/yolo11n.pt
2025-12-07 10:10:34,962 - INFO - Initialized UltimateDatasetCleaner
2025-12-07 10:10:34,962 - INFO -   Blur threshold: 100.0
2025-12-07 10:10:34,962 - INFO -   BBox area range: 1000 - 100000
2025-12-07 10:10:34,962 - INFO -   IoU threshold: 0.5
2025-12-07 10:10:34,962 - INFO - ============================================================
2025-12-07 10:10:34,962 - INFO - STARTING ULTIMATE DATASET CLEANING PIPELINE
2025-12-07 10:10:34,962 - INFO - ============================================================
2025-12-07 10:10:34,962 - INFO -
ðŸ”§ Cleaning TRAIN split...
Cleaning train: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 17044/17044 [06:21<00:00, 44.72image/s]
2025-12-07 10:16:56,169 - INFO - 
ðŸ”§ Cleaning VAL split...
Cleaning val: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4922/4922 [01:58<00:00, 41.40image/s]
2025-12-07 10:18:55,071 - INFO - 
ðŸ”§ Cleaning TEST split...
Cleaning test: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2470/2470 [00:58<00:00, 42.53image/s]
2025-12-07 10:19:53,162 - INFO - ðŸ“„ Cleaning report saved to: datasets\03_cleaned\ultimate_cleaning_report.json
2025-12-07 10:19:53,163 - INFO - ðŸ“ Cleaned dataset structure created at: datasets\03_cleaned

======================================================================
DATASET CLEANING - COMPLETE SUMMARY
======================================================================

ðŸ“Š PROCESSING STATISTICS
   Total images processed: 24,436
   Images kept (cleaned): 22,167 (90.7%)
   Images flagged for review: 2,269 (9.3%)
   Images removed: 2,269

ðŸš© FLAGGED IMAGES BY CATEGORY
   No Valid Plates          :  1317 (58.0%)
   Unusual Aspect Ratio     :  1212 (53.4%)
   Bbox Too Large           :   913 (40.2%)
   Mislabeled               :   908 (40.0%)
   Bbox Too Small           :   769 (33.9%)
   Blurry                   :   751 (33.1%)
   Too Dark                 :   157 (6.9%)
   Low Iou 0.02             :   103 (4.5%)
   Low Iou 0.00             :    97 (4.3%)
   Low Iou 0.03             :    97 (4.3%)
   Low Iou 0.01             :    80 (3.5%)
   Low Iou 0.04             :    78 (3.4%)
   Low Iou 0.05             :    71 (3.1%)
   Low Iou 0.10             :    67 (3.0%)
   Low Iou 0.14             :    66 (2.9%)
   Low Iou 0.13             :    65 (2.9%)
   Low Iou 0.12             :    64 (2.8%)
   Low Iou 0.11             :    59 (2.6%)
   Low Iou 0.06             :    53 (2.3%)
   Low Iou 0.07             :    48 (2.1%)
   Low Iou 0.15             :    48 (2.1%)
   Low Iou 0.08             :    46 (2.0%)
   Low Iou 0.09             :    37 (1.6%)
   Low Iou 0.16             :    37 (1.6%)
   Low Iou 0.17             :    34 (1.5%)
   Low Iou 0.18             :    24 (1.1%)
   Low Iou 0.19             :    22 (1.0%)
   Low Iou 0.20             :    13 (0.6%)
   Low Iou 0.21             :    11 (0.5%)
   Low Contrast             :    11 (0.5%)
   Low Iou 0.22             :     6 (0.3%)
   Too Bright               :     5 (0.2%)
   Low Iou 0.23             :     4 (0.2%)
   Low Iou 0.25             :     4 (0.2%)
   Low Iou 0.37             :     4 (0.2%)
   Low Iou 0.47             :     4 (0.2%)
   Low Iou 0.24             :     4 (0.2%)
   Low Iou 0.45             :     4 (0.2%)
   Low Iou 0.46             :     3 (0.1%)
   Low Iou 0.28             :     3 (0.1%)
   Low Iou 0.27             :     3 (0.1%)
   Low Iou 0.40             :     2 (0.1%)
   Low Iou 0.35             :     2 (0.1%)
   Low Iou 0.43             :     2 (0.1%)
   Low Iou 0.30             :     2 (0.1%)
   Low Iou 0.26             :     1 (0.0%)
   Low Iou 0.49             :     1 (0.0%)
   Low Iou 0.41             :     1 (0.0%)
   Low Iou 0.44             :     1 (0.0%)
   Low Iou 0.34             :     1 (0.0%)
   Low Iou 0.39             :     1 (0.0%)
   Low Iou 0.42             :     1 (0.0%)
   Low Iou 0.38             :     1 (0.0%)
   Low Iou 0.36             :     1 (0.0%)

ðŸ”§ ISSUES FIXED
   Clipped Bbox             : 21199

ðŸ“ˆ QUALITY METRICS
   Cleaning rate: 90.7%
   Flagging rate: 9.3%
   Avg issues per image: 0.30
   Most common issue: No Valid Plates

ðŸ“ OUTPUT LOCATIONS
   Cleaned dataset: datasets\03_cleaned
   Flagged images: datasets\05_flagged
   Cleaning report: datasets\03_cleaned\ultimate_cleaning_report.json

ðŸ’¡ NEXT STEPS
   1. Review flagged images in the flagged directory
   2. Use cleaned dataset for training
   3. Consider augmenting the cleaned dataset
======================================================================

Cleaning complete. Report saved to: datasets\03_cleaned\ultimate_cleaning_report.json